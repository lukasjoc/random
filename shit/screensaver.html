<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>Screensaver Playground</title>

  <style>
    h1::before {
      content: "Normal page";
    }

    body.screensaver h1::before {
      content: "Screensaver enabled";
    }

    body {
      background-color: #5d7;
      transition: background-color .5s ease;
    }

    body.screensaver {
      background-color: #57d;
    }
  </style>
</head>

<body>
  <h1></h1>
  <script>
    "use strict"

    const SCREENSAVER_THRESHOLD_SECONDS = 5
    let screensaver_is_enabled // bool

    function on_user_inactivity() {
      setTimeout(() => {
        screensaver_is_enabled = false
        screensaver_enable()
      }, SCREENSAVER_THRESHOLD_SECONDS * 1000)
    }
    window.addEventListener("blur", () => on_user_inactivity(), { passive: true })

    function on_user_activity() {
      screensaver_is_enabled = true
      screensaver_disable()
    }
    const events = ["scroll", "keydown", "keyup", "pointermove", "pointerdown", "pointerup"]
    for (const activity of events) {
      document.addEventListener(activity, () => on_user_activity(), { passive: true })
    }


    function screensaver_enable() {
      if (!screensaver_is_enabled) {
        screensaver_is_enabled = true
        console.log("screensaver enabled")
        document.body.classList.add("screensaver")
      }
    }

    function screensaver_disable() {
      if (screensaver_is_enabled) {
        screensaver_is_enabled = false
        console.log("screensaver disabled")
        document.body.classList.remove("screensaver")
      }
    }

  </script>
</body>

</html>
